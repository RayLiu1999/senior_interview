# 什麼是 CI/CD？它包含哪些核心概念？

- **難度**: 5
- **重要程度**: 5
- **標籤**: `CI/CD`, `DevOps`, `Automation`

## 問題詳述

CI/CD 是現代軟體開發流程中的關鍵實踐。請解釋什麼是持續整合（CI）、什麼是持續交付（CD）和持續部署（CD），並說明它們之間的關係以及各自的核心概念。

## 核心理論與詳解

CI/CD 是一個統稱，代表了**持續整合 (Continuous Integration)**、**持續交付 (Continuous Delivery)** 和 **持續部署 (Continuous Deployment)** 的組合。它是一套通過自動化來頻繁、可靠地交付軟體的實踐。

![CI/CD 流程](https://i.imgur.com/3sL8i2p.png)

### 1. 持續整合 (Continuous Integration, CI)

持續整合是一種軟體開發實踐，要求開發人員**頻繁地**將他們的程式碼變更合併到一個共享的中央程式碼庫中。

- **核心概念**:
  - **頻繁提交**: 開發者每天至少提交一次程式碼到主幹分支（如 `main` 或 `develop`）。
  - **自動化建置 (Automated Build)**: 每當有新的程式碼提交時，CI 伺服器會自動觸發一個建置流程，將程式碼編譯成可執行的產物。
  - **自動化測試 (Automated Test)**: 在建置成功後，會自動執行一系列的測試（如單元測試、整合測試），以快速發現整合錯誤。
  - **快速回饋**: 如果建置或測試失敗，CI 系統會立即通知相關的開發人員，以便他們能夠快速修復問題。

- **目標**:
  - **及早發現錯誤**: 在開發週期的早期快速發現並修復整合問題，避免問題積累到後期導致「整合地獄」。
  - **提高程式碼品質**: 自動化測試確保了每次變更都符合品質標準。
  - **減少手動工作**: 自動化了重複的建置和測試工作。

### 2. 持續交付 (Continuous Delivery, CD)

持續交付是持續整合的自然延伸。它確保了任何通過所有自動化測試的程式碼變更，都可以**隨時被部署**到生產環境中。

- **核心概念**:
  - **基於 CI**: 持續交付建立在持續整合的基礎之上。
  - **自動化部署到類生產環境**: 在 CI 流程之後，程式碼會被自動部署到一個或多個類生產環境（如測試環境、預備環境 Staging）。
  - **進一步的自動化測試**: 在這些環境中，會執行更全面的自動化測試，如使用者驗收測試 (UAT)、效能測試、端到端測試等。
  - **一鍵式部署到生產**: 整個流程的最終產物是一個**準備好**部署到生產環境的版本。將這個版本部署到生產環境的這一步**是手動的**，通常由一個按鈕觸發。

- **目標**:
  - **降低部署風險**: 由於每次變更都經過了充分的自動化測試，因此部署到生產的風險大大降低。
  - **提高交付速度**: 能夠隨時將新功能或修復交付給使用者，縮短了從想法到上線的時間。
  - **建立可信的發布流程**: 任何人都可以通過一個簡單的動作來觸發一次可靠的發布。

### 3. 持續部署 (Continuous Deployment, CD)

持續部署是持續交付的下一個階段，也是 CI/CD 流程的最高級別的自動化。它將「手動部署到生產」這一步也自動化了。

- **核心概念**:
  - **完全自動化**: 每一筆通過所有自動化測試的程式碼變更，都會**自動地、無需人工干預地**部署到生產環境中。
  - **強大的監控和回滾機制**: 由於部署是自動的，因此需要非常強大的監控系統來即時發現生產環境中的問題，並具備快速自動回滾到上一個穩定版本的能力。

- **目標**:
  - **最大化交付速度**: 實現最快速的軟體交付流程，開發人員提交的程式碼可以在幾分鐘內就上線。
  - **加速回饋循環**: 能夠快速地從真實使用者的使用情況中獲得回饋。

### 關係總結

- **CI 是基礎**: 沒有 CI，就談不上 CD。CI 確保了程式碼可以被可靠地整合和測試。
- **持續交付是 CI 的延伸**: 它將 CI 的產物自動化地準備好，使其處於「隨時可部署」的狀態。
- **持續部署是持續交付的極致**: 它消除了手動部署的步驟，實現了從提交到上線的完全自動化。

**一個簡單的比喻**:

- **CI**: 就像是汽車工廠的零件生產線，確保每個零件（程式碼變更）都是合格的，並且可以和其他零件完美組裝（整合）。
- **持續交付**: 就像是整車組裝線，將所有合格的零件組裝成一輛完整的、通過所有安全測試的汽車，並停放在倉庫裡，**等待經理按下按鈕**就運輸出廠。
- **持續部署**: 則是在汽車組裝完成並通過測試後，**自動駕駛**出工廠，直接交付到客戶手中。

在實踐中，大多數團隊會先實作**持續整合**，然後逐步邁向**持續交付**。是否要實作**持續部署**，則取決於業務需求、團隊對自動化測試的信心以及風險控制能力。
