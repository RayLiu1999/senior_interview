# 什麼是 Kubernetes？它解決了什麼問題？

- **難度**: 4
- **標籤**: `Kubernetes`, `Container Orchestration`, `Cloud Native`

## 問題詳述

Kubernetes（簡稱 K8s）是什麼？它在現代雲原生架構中扮演什麼角色？它主要解決了哪些問題？

## 核心理論與詳解

### 什麼是 Kubernetes

**Kubernetes** 是一個開源的容器編排平台，最初由 Google 設計並捐贈給 Cloud Native Computing Foundation (CNCF)。它用於自動化部署、擴展和管理容器化應用程式。

**核心定位**：
- **容器編排引擎**：管理大規模容器集群
- **雲原生基礎設施**：現代微服務架構的標準平台
- **聲明式系統**：透過描述期望狀態來管理應用

### Kubernetes 解決的核心問題

#### 1. **容器調度與資源管理**

**問題**：
- 在多台機器上如何決定將容器部署到哪台機器？
- 如何有效利用集群資源，避免資源浪費或過載？

**K8s 解決方案**：
- **自動調度**：根據資源需求和可用性自動選擇最佳節點
- **資源配額**：透過 Requests 和 Limits 控制資源使用
- **親和性規則**：支援節點親和性、Pod 親和性/反親和性

#### 2. **高可用性與自我修復**

**問題**：
- 容器崩潰後如何自動重啟？
- 節點故障時如何自動遷移容器？

**K8s 解決方案**：
- **自我修復**：自動重啟失敗的容器
- **健康檢查**：透過 Liveness 和 Readiness Probe 監控應用狀態
- **副本管理**：確保指定數量的 Pod 副本始終運行

#### 3. **服務發現與負載均衡**

**問題**：
- 容器 IP 是動態的，如何讓服務之間相互發現？
- 如何在多個容器實例之間分配流量？

**K8s 解決方案**：
- **Service 抽象**：提供穩定的服務端點
- **內建 DNS**：自動為 Service 創建 DNS 記錄
- **負載均衡**：在 Pod 之間自動分配流量

#### 4. **滾動更新與版本控制**

**問題**：
- 如何在不停機的情況下更新應用？
- 更新失敗時如何快速回滾？

**K8s 解決方案**：
- **滾動更新**：逐步替換舊版本 Pod
- **版本歷史**：保留歷史版本記錄
- **一鍵回滾**：快速回滾到之前的穩定版本

#### 5. **配置管理與密鑰管理**

**問題**：
- 如何管理不同環境的配置？
- 如何安全地存儲和使用敏感資訊？

**K8s 解決方案**：
- **ConfigMap**：管理非敏感配置資料
- **Secret**：安全存儲敏感資訊
- **環境變數注入**：將配置注入到容器中

#### 6. **自動擴展與縮容**

**問題**：
- 如何根據負載自動調整應用實例數量？
- 如何在流量低谷時節省資源？

**K8s 解決方案**：
- **HPA (Horizontal Pod Autoscaler)**：根據 CPU/記憶體使用率自動擴展
- **VPA (Vertical Pod Autoscaler)**：自動調整容器資源配置
- **Cluster Autoscaler**：根據需求自動擴展集群節點

### Kubernetes 的核心優勢

1. **聲明式管理**
   - 描述期望狀態，K8s 自動達成
   - 易於版本控制和審計

2. **可移植性**
   - 支援多種雲平台（AWS、Azure、GCP）
   - 支援本地部署和混合雲

3. **可擴展性**
   - 通過 CRD (Custom Resource Definition) 擴展功能
   - 豐富的生態系統和插件

4. **社群支援**
   - CNCF 頂級項目，社群活躍
   - 大量第三方工具和整合方案

### 典型應用場景

- **微服務架構**：管理大量微服務實例
- **持續交付**：與 CI/CD 流程整合
- **多租戶平台**：透過 Namespace 實現資源隔離
- **混合雲部署**：統一管理不同環境的應用

## 總結

Kubernetes 是現代雲原生應用的基礎設施層，它解決了容器化應用在生產環境中的調度、高可用、網路、存儲、配置管理等一系列複雜問題。對於資深後端工程師而言，掌握 K8s 是必備技能，它不僅是一個工具，更代表了一種現代化的應用部署和管理理念。
