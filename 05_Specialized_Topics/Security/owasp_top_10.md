# OWASP Top 10 概覽

- **難度**: 6
- **重要性**: 5
- **標籤**: `Security`, `OWASP`, `Best Practices`

## 問題詳述

什麼是 OWASP Top 10？請列舉並簡要解釋當前版本中的十大安全風險。為什麼 OWASP Top 10 對於後端開發者如此重要？

## 核心理論與詳解

**OWASP (Open Web Application Security Project)** 是一個致力於改善軟體安全性的非營利組織。OWASP Top 10 是該組織定期發布的一份清單,列出了 Web 應用程式面臨的最關鍵、最普遍的安全風險。

這份清單基於來自全球數百個組織的真實資料、安全專家的意見以及社群的回饋,代表了業界對 Web 安全威脅的共識。對於後端開發者而言,OWASP Top 10 是**必知必會**的安全知識基礎。

---

### OWASP Top 10 - 2021 版本

以下是 OWASP Top 10 (2021) 的十大安全風險:

#### 1. A01:2021 - 權限控制失效 (Broken Access Control)

-   **描述**: 使用者能夠超越其授權範圍,存取、修改或刪除不屬於他們的資料或功能。
-   **範例**:
    -   透過修改 URL 參數 (如 `userId=123` 改為 `userId=124`) 存取其他使用者的資料。
    -   未經授權直接訪問管理員 API 端點。
    -   水平越權 (存取同級別其他使用者資料) 或垂直越權 (普通使用者獲得管理員權限)。
-   **影響**: 從 2017 年的第五名躍升至第一名,顯示權限控制問題的嚴重性和普遍性。

#### 2. A02:2021 - 加密機制失效 (Cryptographic Failures)

-   **描述**: 與敏感資料的保護失敗相關,包括傳輸中或靜態儲存的資料未正確加密。
-   **範例**:
    -   使用明文或弱加密演算法 (如 MD5, SHA1) 儲存密碼。
    -   敏感資料透過 HTTP 而非 HTTPS 傳輸。
    -   使用過時的加密協定 (如 SSL 2.0/3.0, TLS 1.0)。
-   **影響**: 導致敏感資料 (如密碼、信用卡號、個人資料) 洩露。

#### 3. A03:2021 - 注入攻擊 (Injection)

-   **描述**: 當不受信任的資料被直接傳送到解釋器 (Interpreter) 時,攻擊者可以注入惡意指令。
-   **類型**:
    -   **SQL Injection**: 注入 SQL 指令操控資料庫。
    -   **NoSQL Injection**: 針對 NoSQL 資料庫的注入攻擊。
    -   **OS Command Injection**: 注入作業系統指令。
    -   **LDAP Injection**: 針對 LDAP 查詢的注入。
-   **範例**: 在登入表單中輸入 `' OR '1'='1` 繞過身份驗證。
-   **防禦**: 使用參數化查詢 (Prepared Statements)、ORM、輸入驗證與過濾。

#### 4. A04:2021 - 不安全的設計 (Insecure Design)

-   **描述**: 在軟體設計階段就存在的缺陷,即使實現完美也無法防禦的風險。
-   **範例**:
    -   缺乏速率限制導致暴力破解成功。
    -   未考慮威脅建模 (Threat Modeling)。
    -   業務邏輯漏洞 (如購物車可以設定為負數獲得退款)。
-   **強調**: 安全性應該從設計階段就開始考慮,而不僅僅是實現階段。

#### 5. A05:2021 - 安全設定錯誤 (Security Misconfiguration)

-   **描述**: 應用程式、伺服器、資料庫或平台的安全設定不當或使用預設配置。
-   **範例**:
    -   使用預設的管理員帳號密碼。
    -   錯誤訊息洩露堆疊追蹤 (Stack Trace) 或系統資訊。
    -   未禁用不必要的服務或功能。
    -   雲端儲存 (如 S3) 權限設定為公開。
-   **防禦**: 使用安全基線配置、定期審計、移除不必要的功能。

#### 6. A06:2021 - 危險或過時的組件 (Vulnerable and Outdated Components)

-   **描述**: 使用已知有安全漏洞的第三方套件、函式庫或框架。
-   **範例**:
    -   使用有 CVE (Common Vulnerabilities and Exposures) 漏洞編號的舊版本套件。
    -   未定期更新依賴套件。
-   **防禦**: 使用依賴掃描工具 (如 Snyk, Dependabot)、定期更新套件、移除未使用的依賴。

#### 7. A07:2021 - 身份識別與驗證失效 (Identification and Authentication Failures)

-   **描述**: 與使用者身份確認、會話管理相關的漏洞。
-   **範例**:
    -   允許暴力破解攻擊 (無速率限制)。
    -   使用弱密碼或無密碼強度要求。
    -   會話 ID 在 URL 中暴露。
    -   會話固定攻擊 (Session Fixation)。
    -   未正確處理會話過期或登出。
-   **防禦**: 實施多因素驗證 (MFA)、強密碼策略、安全的會話管理、防止自動化攻擊。

#### 8. A08:2021 - 軟體與資料完整性失效 (Software and Data Integrity Failures)

-   **描述**: 程式碼和基礎設施未能防範完整性驗證失敗。
-   **範例**:
    -   從不受信任的 CDN 載入程式碼而不驗證其完整性 (SRI - Subresource Integrity)。
    -   不安全的反序列化 (Insecure Deserialization) 導致遠端程式碼執行。
    -   CI/CD 流程未經適當驗證,允許惡意程式碼進入生產環境。
-   **防禦**: 使用數位簽章、完整性檢查、安全的序列化機制。

#### 9. A09:2021 - 安全日誌與監控失效 (Security Logging and Monitoring Failures)

-   **描述**: 缺乏足夠的日誌記錄、監控和即時告警,導致無法及時發現和回應攻擊。
-   **範例**:
    -   登入失敗、存取控制失敗等安全事件未被記錄。
    -   日誌未被集中儲存或監控。
    -   無異常流量或異常行為的告警機制。
-   **影響**: 攻擊者可以長時間潛伏在系統中而不被發現,平均偵測時間可能長達數個月。

#### 10. A10:2021 - 伺服器端請求偽造 (Server-Side Request Forgery, SSRF)

-   **描述**: 應用程式在未驗證使用者提供的 URL 的情況下獲取遠端資源,攻擊者可以誘使伺服器發送請求到意外的目的地。
-   **範例**:
    -   攻擊者提供 `http://localhost:6379/` 來存取內部 Redis 服務。
    -   存取雲端元資料 API (如 AWS 的 `http://169.254.169.254/`) 竊取憑證。
-   **防禦**: 驗證和清理所有使用者提供的 URL、使用白名單、網路隔離。

---

### 為什麼 OWASP Top 10 對後端開發者如此重要？

1.  **業界標準**: 它代表了資訊安全領域的共識,許多組織將其作為安全基線。
2.  **面試必考**: 幾乎所有資深後端工程師的面試都會涉及 OWASP Top 10 中的概念。
3.  **實際威脅**: 這些漏洞每天都在真實世界中被利用,造成數百萬美元的損失和資料洩露。
4.  **防禦藍圖**: 它為開發者提供了一份清晰的檢查清單,指導如何構建更安全的應用程式。

### 結論

OWASP Top 10 不僅僅是一份清單,它是每個後端開發者必須熟練掌握的安全知識體系。深入理解這十大風險的原理、攻擊手法和防禦措施,是成為一名優秀資深工程師的必經之路。
